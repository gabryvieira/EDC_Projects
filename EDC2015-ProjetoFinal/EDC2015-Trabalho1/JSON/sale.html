<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Books Sales</title>
        <link href="../Content/bootstrap.min.css" rel="stylesheet" />
        <link href="../Content/font-awesome.css" rel="stylesheet" />
        <script>
        function processArray(arr) {
            
            arr.reverse();
            

            var out = "<table class=\"table table-striped table-bordered table-condensed\"><tr><th>Title &nbsp &nbsp</th></tr>";
            var i;
            //alert("arr.length:" + arr.length);
            for (i = 0; i < arr.length; i++) {
                out += '<tr><td>'+'<i class="fa fa-book"></i>&nbsp' + ' ' + arr[i].title + '</td><td>'
                    + "<table class=\"table table-striped  table-condensed\"><tr><th>orderNum</th><th>orderDate</th><th>quantity</th><th>payTerms</th><th>store</th></tr>";
                for (var j = 0; j < arr[i].sales.length; j++) {
                    out += "<tr><td>" + '<i class="fa fa-bookmark"></i>&nbsp'+ ' ' + arr[i].sales[j].orderNum + "</td>"
                     + "<td>" + arr[i].sales[j].orderDate + "</td>"
                     + "<td>" + arr[i].sales[j].quantity + "</td>"
                     + "<td>" + arr[i].sales[j].payTerms + "</td>"
                     + "<td>" + arr[i].sales[j].store.name + "<br>" + arr[i].sales[j].store.address + "<br>" + arr[i].sales[j].store.city + ", " + arr[i].sales[j].store.state + ", " + arr[i].sales[j].store.zip + "</td>"
                + "</tr>";
                }
                out += "</table></td></tr>";
            }
            out += "</table>";
            document.getElementById("demo").innerHTML = out;
        }
        </script>
        <script>
        function sortAZ() {
            arr = array;
            var result = JSON.stringify(arr, null, 4).split("\n").join("<br/>");
            result = result.split(" ").join("&nbsp;");
            var out = "<table class=\"table table-striped table-hover\"><tr><th>title</th><th>sales</th></tr>";

            arr.reverse(function (a, b) {
                return a.title.localeCompare(b.title);
            });

            var i;
            for (i = 0; i < arr.length; i++) {
                out += '<tr><td>' + arr[i].title + '</td><td>'
                    + "<table class=\"table table-striped table-bordered table-condensed\"><tr><th>orderNum</th><th>orderDate</th><th>quantity</th><th>payTerms</th><th>store</th></tr>";
                for (var j = 0; j < arr[i].sales.length; j++) {
                    out += "<tr><td>" + arr[i].sales[j].orderNum + "</td>"
                     + "<td>" + arr[i].sales[j].orderDate + "</td>"
                     + "<td>" + arr[i].sales[j].quantity + "</td>"
                     + "<td>" + arr[i].sales[j].payTerms + "</td>"
                     + "<td>" + arr[i].sales[j].store.name + "<br>" + arr[i].sales[j].store.address + "<br>" + arr[i].sales[j].store.city + ", " + arr[i].sales[j].store.state + ", " + arr[i].sales[j].store.zip + "</td>"
                + "</tr>";
                }
                out += "</table></td></tr>";
            }
            out += "</table>";
            document.getElementById("demo").innerHTML = out;
        }
        </script>

        <script>
        function sortZA() {
            arr = array;
            var result = JSON.stringify(arr, null, 4).split("\n").join("<br/>");
            result = result.split(" ").join("&nbsp;");
            var out = "<table class=\"table table-striped table-hover\"><tr><th>title</th><th>sales</th></tr>";

            arr.reverse(function (a, b) {
                return a.title.localeCompare(b.title);
            });

            var i;
            for (i = 0; i < arr.length; i++) {
                out += '<tr><td>' + arr[i].title + '</td><td>'
                    + "<table class=\"table table-striped table-bordered table-condensed\"><tr><th>orderNum</th><th>orderDate</th><th>quantity</th><th>payTerms</th><th>store</th></tr>";
                for (var j = 0; j < arr[i].sales.length; j++) {
                    out += "<tr><td>" + arr[i].sales[j].orderNum + "</td>"
                     + "<td>" + arr[i].sales[j].orderDate + "</td>"
                     + "<td>" + arr[i].sales[j].quantity + "</td>"
                     + "<td>" + arr[i].sales[j].payTerms + "</td>"
                     + "<td>" + arr[i].sales[j].store.name + "<br>" + arr[i].sales[j].store.address + "<br>" + arr[i].sales[j].store.city + ", " + arr[i].sales[j].store.state + ", " + arr[i].sales[j].store.zip + "</td>"
                + "</tr>";
                }
                out += "</table></td></tr>";
            }
            out += "</table>";
            document.getElementById("demo").innerHTML = out;
        }
        </script>

        <script>
        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }
        </script>

    </head>
    <body>
        <nav class="navbar navbar-default">
            <ul class="nav navbar-nav">
                <li><a href="default.html"> <i class="fa fa-leaf"></i> </a></li>
                <li><a href="default.html"> Home </a></li>
                <li><a href="../About.aspx"> About </a></li>
                <li><a href="../Contact.aspx"> Contact </a></li>
                <li><a href="../authors.aspx"> <i class="fa fa-users"></i></a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../Account/Register.aspx"> Register </a></li>
                <li><a href="../Account/Login.aspx"> Login </a></li>
            </ul>
        </nav>

        <div class="col-lg-10 col-lg-offset-1">
            <h2>Book Sales</h2>
        </div>
        <div class="col-lg-10 col-lg-offset-1">
            <a href="default.html"><i class="fa fa-backward"></i>&nbsp  Back to Authors</a>
        </div>

        <div class="col-lg-10 col-lg-offset-1 dropdown">
            <div class="label">
                Sort by:
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" onclick="sortAZ()">
                    Name(Z-A)
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li><a href="sales.html" onclick="sortAZ()">Name(A - Z) </a></li>
                </ul>
            </div>
        </div>

        <div class="container-fluid">
            <div id="demo" class="col-lg-10 col-lg-offset-1"></div>
        </div>

        <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script>
        var myUrl = "http://192.168.160.36/JSON/getAuthorSales.aspx";
        $.ajax({
            type: "GET",
            url: myUrl,
            data: { author_ID: getParameterByName("author_ID") },
            dataType: "jsonp",
            success: processArray,
            error: function (xhr, status, err) {
            }
        });
        </script>




    </body>
</html>
